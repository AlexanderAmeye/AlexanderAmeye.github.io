@unity3d shadergraph now allows you to define custom function nodes! This opens up a lot of possibilities, but my favorite one is loops, they allow us to drastically reduce graph size. Let's dive in! #shadergraph #unity3d

For this example I'll use the cracked ice shader made by @BinaryImpactG. For this shader, we add the cracks under the ice and distort the UV's to get a parallax effect that gives the illusion of being 3D. 

When we want to add cracks deeper in the ice, the graph rapidly becomes very large in size. This is the graph for only 5 iterations! You can see that there are a lot of repeated nodes with minimal changes, what if we could do better?

Let's add a custom-function node. In this custom function node we can define our inputs/outputs as well as refer to a source file. I am referring to the file 'parallax.magic' that will hold our loop code. Also enter the name of the custom function you are creating!

My custom node allows me to enter how many subsurface cracks I want. The size of the graph no longer increases when I want to add more cracks. Look at how small the section in the graph became!

The parallax.magic file is just a regular text file with a custom named file extension. The file extension can be whatever you want it to be so I named it 'magic'! ? The file holds a function with a for-loop. Here is the code for my node. https://pastebin.com/FTy1f0hq

Now that I made this custom node function I can easily add as many cracks as I want without having to add more nodes. Super easy!

The shader I used was just to demonstrate the custom function nodes. In the tutorial of @BinaryImpactG you'll find much more information on how to make the shader look better with surface snow etc. I highly recommend you to check them out! https://www.youtube.com/watch?v=rlGNbq5p5CQ&t=421s


